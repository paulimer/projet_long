---
output: html_document
bibliography: ./Projet_long.bib
---

# Rapport sur la déconvolution single-cell


## Introduction

La technologie Visium de 10x Genomics est une des deux technologies majeures pour étudier l'expression des gènes dans leur contexte spatial. Historiquement, beaucoup [@moses_museum_2022] font débuter la transcriptomique spatiale à la fin des années 1990 avec l'apparition du smFISH. Deux grandes approches subsistent aujourd'hui, l'une basée sur la microscopie optique via la fluorescence, et la seconde basée sur le Next Generation Sequencing (NGS) via le spatial barcoding. La plateforme Genom'IC a fait le choix de la seconde, de manière logique puisqu'elle se spécialise dans la transcriptomique NGS, et a choisi la technologie Visium (plutôt que sa concurrente, Slide-Seq) de 10x, ayant déjà une bonne expérience dans la technologie single-cell commercialisée par cette entreprise.

Toutes les approches actuelles, basée sur la microscopie comme sur le NGS, résultent de compromis entre la largeur de détection (avec ou sans *a priori*), la résolution (qui peut aller jusqu'à la cellule unique), l'efficacité de détection et la surface du tissu (ces deux dernières étant généralement opposées), et enfin la facilité d'utilisation et la compatibilité avec certaines méthodes de conservation de tissus (toutes fonctionnent sur des tissus congelés, mais seule la technologie Visium peut utiliser le FFPE). La technologie Visium est aujourd'hui la plus employée [@moses_museum_2022]. Elle n'a pas d'a priori (ne fonctionne pas via un panel de gène pré-déterminé), ce qui se paye par un relativement faible nombre de gène détecté (efficacité de détection de 6 à 15%), ainsi qu'une résolution assez faible. En effet, la plaque sur laquelle est placé le tissu est divisée en spots de 55µm de rayon, ce qui excède nettement la taille moyenne d'une cellule. En fonction du tissu, il est généralement accepté qu'il y a entre 5 et 10 cellules par spot. Chaque spot de capture est cadrillé par des fragments d'ARN ancrés, qui possèdent entre autre une queue poly(dT), qui permet de capturer les ARNm polyA complémentaires, ainsi qu'un code unique par spot (spatial barcode). Après séquençage, il est donc possible de retrouver de quel spot provient quel read. L'information au niveau cellulaire n'est donc pas capturée.

![./10xbarcode.png](La technologie Visium fonctionne grâce au spatial barcoding)

La déconvolution single-cell est une tentative de remédier à cette limitation de la résolution du Visium. Chaque spot peut en effet être considéré comme un mélange potentiellement hértérogène de transcriptomes provenant de différentes cellules, et le but de la déconvolution est donc de définir quelle somme pondérée de différent signaux (transcriptomes) permet d'aboutir au mélange constaté. La plupart des méthodes développées pour répondre à cette question se basent sur une référence, c'est à dire un jeu de donnée single-cell annoté (i.e. affectant des types cellulaires aux cellules d'un jeu de données single-cell) pour découvrir lesquels de ces types cellulaires contribuent à quels spots. C'est un champ de recherche extrêmement actif, avec un nombre très important de méthodes développées dans les dernières années, et de tentatives de les comparer et classer ( @li_benchmarking_2022 , @chen_comprehensive_2022 , @li_comprehensive_2023 ). De nombreuses approches méthodologiques ont été proposées, probabilistes fréquentistes (par Maximum Likelihood Estimation (MLE)) telles RCTD [@cable_robust_2022], bayésienne variationnelle telle que cell2location [@kleshchevnikov_cell2location_2022], bayésienne (par estimation du Maximum A Posteriori (MAP)) comme stereoscope [@andersson_single-cell_2020], une variation des moindres carrés (dampened weighted least squares) spatialDWLS [@dong_spatialdwls_2021], une approche Deep Learning nommée Tangram [@biancalani_deep_2021], une implémentation d'un *shortest augmenting path optimization algorithm* CytoSPACE [@vahid_high-resolution_2023], ou encore une approche auto-supervisée basée sur les *graph neural networks* GraphST [@long_spatially_2023]. Nous avons également identifié une méthode ne nécessitant pas de référence single-cell annotée, STDeconvolve, basée sur la Latent Dirichlet Allocation (fréquemment utilisée en *text mining*), STDeconvolve [@miller_reference-free_2022]. Cette liste de méthodes publiées dans les meilleurs journaux est non exaustive, mais elle montre que qu'il peut-être difficile, voire impossible, de distinguer une méthode supérieure aux autres dans tous les cas, sachant que même les dernières publiées ne se comparent pas à l'intégralité de leurs concurrents. En effet, pour par exemple Tangram et GraphST, la déconvolution single-cell n'est qu'une des possibilité offerte par l'outil, tandis que d'autres sont sorties au début de l'explosion du domaine, comme spatialDWLS et stereoscope. Les trois benchmarks précédemment cités peuvent servir de guide, mais ils souffrent également de quelques limitations : tout d'abord, en fonction de leur date de publication, ils ne comparent pas tous les outils du domaines. Mais plus important encore, il n'existe pas de *ground truth*, c'est à dire de jeu de données à la résolution cellulaire, sans *a priori* (sans panel de gène), et de la même surface de tissus. Les auteurs de ces articles utilisent donc deux types de jeux de données : des jeux de données sur un nombre réduit de cellule avec panel de gène, dont la résolution est réduite. Il s'agit alors pour les outils de déconvolution de retrouver quelles cellules ont été mélangées. Le second type consiste en des jeux de données simulés, mais sans certitude absolue quand à leur ressemblance à un jeu de données réels, ou sur le fait qu'ils puissent favoriser un outil par rapport à un autre.


Yoann Martin est le spécialiste transcriptomique spatiale à la plateforme Genom'IC de l'Institut Cochin, et est également intégré à l'équipe d'Éric Pasmant travaillant sur la génétique et l'épigénétique des tumeurs rares. Dans le cadre d'un projet comportant une partie transcriptomique spatiale sur une tumeur rare, il a été amené à utiliser le module stereoscope [@andersson_single-cell_2020], dont l'évaluation dans ce cas particulier est encore en cours. S'il semble pour l'heure prometteur en terme de résultats, stereoscope l'est bien moins en terme de temps de calcul. En effet, sa dernière utilisation (sur CPU) a pris plus de deux semaines pour obtenir des résultats, avec il est vrai une référence conséquente (70k cellules). Ce projet consiste donc en l'évaluation sommaire de quelques unes des méthodes précédemment citées. Sommaire, car une évaluation complète rentrerait plutôt dans le cadre d'un article pour Nature que d'un projet long, et de seulement quelques unes de ces méthodes car toutes ne s'intègrent pas facilement dans le pipeline actuel de la plateforme, qui utilise Seurat, tandis que certains outils utilisent scanpy/squidpy. Ces deux super-packages définissent un workflow et des structures de données pour l'analyse single-cell et spatial transcriptomic, et il est difficile de maintenir les deux alternatives à la plateforme, outre qu'ils soient tout deux difficiles d'approche pour un débutant.

Le but de ce projet est donc de défricher le champ de la déconvolution single-cell, afin de proposer une alternative à stereoscope qui soit plus efficace et plus précise. Dans le cadre du projet scientifique sur la glande surrénale, le temps trop important pris par stereoscope a pour effet d'empêcher l'itération rapide, et en particulier de pouvoir évaluer l'impact de l'évolution de l'annotation single-cell sur la déconvolution. Cette exploration a également pour but d'évaluer l'intérêt d'augmenter les ressources de la plateforme en calcul GPU : en effet nombre de ces outils (cell2location, tangram, stereoscope...) bénéficie de façon importante du fait d'effectuer leurs calculs sur GPU, et un choix pour l'une de ces méthodes aura un impact sur les décisions d'équipement futur.


<!-- parler infra aussi -->
## Glossaire
FFPE : 
MERFISH: 
